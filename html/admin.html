<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg" />
    <link rel="stylesheet" href="../css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
      <div class="login-box">
        <h2><i class="fas fa-user-shield"></i> Admin Login</h2>
        <form id="login-form">
          <div class="input-group">
            <input type="email" id="email" placeholder="Email" required />
          </div>
          <div class="input-group">
            <input
              type="password"
              id="password"
              placeholder="Password"
              required
            />
          </div>
          <button type="submit">
            <i class="fas fa-sign-in-alt"></i>
            Login
          </button>
        </form>
        <div id="login-error" class="error-message"></div>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="admin-dashboard" class="dashboard" style="display: none">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
        </div>
        <div class="header-right">
          <span id="network-status" class="network-status">
            <i class="fas fa-wifi"></i>
            <span id="network-text">Online</span>
          </span>
          <button
            id="retry-connection"
            class="retry-btn"
            style="display: none"
            onclick="adminDashboard.retryConnection()"
          >
            <i class="fas fa-sync-alt"></i>
            Retry
          </button>
          <span id="security-status" class="security-status">
            <i class="fas fa-shield-alt"></i>
            <span id="security-text">Secure</span>
          </span>
          <span id="user-display">
            <i class="fas fa-user"></i>
            Admin
          </span>
          <button onclick="logout()" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            Logout
          </button>
        </div>
      </header>

      <!-- Navigation -->
      <nav class="nav">
        <button class="nav-btn active" data-tab="overview">
          <i class="fas fa-home"></i>
          Overview
        </button>
        <button class="nav-btn" data-tab="tasks">
          <i class="fas fa-tasks"></i>
          Tasks
        </button>
        <button class="nav-btn" data-tab="academics">
          <i class="fas fa-graduation-cap"></i>
          Academics
        </button>
        <button class="nav-btn" data-tab="contacts">
          <i class="fas fa-envelope"></i>
          Contacts
        </button>
        <button class="nav-btn" data-tab="portfolio">
          <i class="fas fa-briefcase"></i>
          Portfolio
        </button>
        <button class="nav-btn" data-tab="portfolio-settings">
          <i class="fas fa-user-edit"></i>
          Portfolio Settings
        </button>
        <button class="nav-btn" data-tab="settings">
          <i class="fas fa-cog"></i>
          Settings
        </button>
        <button
          class="nav-btn"
          onclick="window.open('../html/index.html', '_blank')"
        >
          <i class="fas fa-external-link-alt"></i>
          View Portfolio
        </button>
      </nav>

      <!-- Main Content -->
      <main class="main">
        <!-- Overview Tab -->
        <div id="overview" class="tab active">
          <div class="stats">
            <div class="stat-card">
              <i class="fas fa-tasks"></i>
              <div>
                <h3 id="task-count">0</h3>
                <p>Active Tasks</p>
              </div>
            </div>
            <div class="stat-card">
              <i class="fas fa-envelope"></i>
              <div>
                <h3 id="contact-count">0</h3>
                <p>New Messages</p>
              </div>
            </div>
            <div class="stat-card">
              <i class="fas fa-calendar-alt"></i>
              <div>
                <h3 id="deadline-count">0</h3>
                <p>Upcoming Deadlines</p>
              </div>
            </div>
            <div class="stat-card">
              <i class="fas fa-eye"></i>
              <div>
                <h3 id="view-count">0</h3>
                <p>Portfolio Views</p>
              </div>
            </div>
          </div>

          <div class="calendar-section">
            <div id="calendar"></div>
            <div class="upcoming">
              <h3><i class="fas fa-clock"></i> Upcoming Deadlines</h3>
              <div id="deadlines-list"></div>
            </div>
          </div>
        </div>

        <!-- Tasks Tab -->
        <div id="tasks" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-tasks"></i> Task Management</h2>
            <button onclick="openModal('task')" class="btn-primary">
              <i class="fas fa-plus"></i>
              Add Task
            </button>
          </div>
          <div class="filters">
            <input
              type="text"
              id="task-search"
              placeholder="Search tasks..."
              onkeyup="searchTasks()"
            />
            <select id="task-filter" onchange="filterTasks()">
              <option value="all">All Tasks</option>
              <option value="pending">Pending</option>
              <option value="in-progress">In Progress</option>
              <option value="completed">Completed</option>
            </select>
          </div>
          <div id="tasks-list"></div>
        </div>

        <!-- Academics Tab -->
        <div id="academics" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-graduation-cap"></i> Academic Management</h2>
            <button onclick="openModal('academic')" class="btn-primary">
              <i class="fas fa-plus"></i>
              Add Academic
            </button>
          </div>
          <div id="academics-list"></div>
        </div>

        <!-- Contacts Tab -->
        <div id="contacts" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-envelope"></i> Contact Requests</h2>
            <button onclick="markAllRead()" class="btn-secondary">
              <i class="fas fa-check-double"></i>
              Mark All Read
            </button>
          </div>
          <div id="contacts-list"></div>
        </div>

        <!-- Portfolio Tab -->
        <div id="portfolio" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-briefcase"></i> Portfolio Management</h2>
            <button onclick="openModal('project')" class="btn-primary">
              <i class="fas fa-plus"></i>
              Add Project
            </button>
          </div>
          <div id="projects-list"></div>
        </div>

        <!-- Portfolio Settings Tab -->
        <div id="portfolio-settings" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-user-edit"></i> Portfolio Settings</h2>
          </div>
          <div class="settings-grid">
            <div class="settings-card">
              <h3><i class="fas fa-user"></i> Profile Information</h3>
              <form id="profile-form">
                <div class="form-group">
                  <label>Full Name</label>
                  <input
                    type="text"
                    id="profile-name"
                    placeholder="Your Full Name"
                    required
                  />
                </div>
                <div class="form-group">
                  <label>Title</label>
                  <input
                    type="text"
                    id="profile-title"
                    placeholder="e.g., Software Engineering Student"
                    required
                  />
                </div>
                <div class="form-group">
                  <label>Subtitle</label>
                  <input
                    type="text"
                    id="profile-subtitle"
                    placeholder="e.g., IoT & Robotics Enthusiast"
                    required
                  />
                </div>
                <div class="form-group">
                  <label>About Me</label>
                  <textarea
                    id="profile-about"
                    placeholder="Tell visitors about yourself..."
                    rows="4"
                    required
                  ></textarea>
                </div>
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i>
                  Save Profile
                </button>
              </form>
            </div>

            <div class="settings-card">
              <h3><i class="fas fa-image"></i> Profile Picture</h3>
              <div class="profile-image-upload">
                <div class="current-image">
                  <img
                    id="current-profile-img"
                    src="../assets/profile.svg"
                    alt="Current Profile"
                  />
                </div>
                <div class="upload-options">
                  <input
                    type="file"
                    id="profile-image-input"
                    accept="image/*"
                    style="display: none"
                  />
                  <button
                    type="button"
                    onclick="document.getElementById('profile-image-input').click()"
                    class="btn-secondary"
                  >
                    <i class="fas fa-upload"></i>
                    Upload New Image
                  </button>
                  <button
                    type="button"
                    onclick="resetProfileImage()"
                    class="btn-secondary"
                  >
                    <i class="fas fa-undo"></i>
                    Reset to Default
                  </button>
                </div>
                <p class="upload-hint">
                  Recommended: 400x400px, JPG or PNG format
                </p>
              </div>
            </div>

            <div class="settings-card">
              <h3><i class="fas fa-link"></i> Social Links</h3>
              <form id="social-form">
                <div class="form-group">
                  <label>GitHub URL</label>
                  <input
                    type="url"
                    id="social-github"
                    placeholder="https://github.com/yourusername"
                  />
                </div>
                <div class="form-group">
                  <label>LinkedIn URL</label>
                  <input
                    type="url"
                    id="social-linkedin"
                    placeholder="https://linkedin.com/in/yourusername"
                  />
                </div>
                <div class="form-group">
                  <label>Twitter URL</label>
                  <input
                    type="url"
                    id="social-twitter"
                    placeholder="https://twitter.com/yourusername"
                  />
                </div>
                <div class="form-group">
                  <label>Email</label>
                  <input
                    type="email"
                    id="social-email"
                    placeholder="your.email@example.com"
                  />
                </div>
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i>
                  Save Social Links
                </button>
              </form>
            </div>

            <div class="settings-card">
              <h3><i class="fas fa-chart-bar"></i> Statistics</h3>
              <form id="stats-form">
                <div class="form-group">
                  <label>Years of Experience</label>
                  <input
                    type="number"
                    id="stats-experience"
                    placeholder="3"
                    min="0"
                    max="50"
                  />
                </div>
                <div class="form-group">
                  <label>Projects Completed</label>
                  <input
                    type="number"
                    id="stats-projects"
                    placeholder="15"
                    min="0"
                    max="1000"
                  />
                </div>
                <div class="form-group">
                  <label>Technologies Known</label>
                  <input
                    type="number"
                    id="stats-technologies"
                    placeholder="5"
                    min="0"
                    max="100"
                  />
                </div>
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i>
                  Save Statistics
                </button>
              </form>
            </div>

            <div class="settings-card">
              <h3><i class="fas fa-map-marker-alt"></i> Contact Information</h3>
              <form id="contact-info-form">
                <div class="form-group">
                  <label>Location</label>
                  <input
                    type="text"
                    id="contact-location"
                    placeholder="e.g., Colombo, Sri Lanka"
                  />
                </div>
                <div class="form-group">
                  <label>Email</label>
                  <input
                    type="email"
                    id="contact-email"
                    placeholder="your.email@example.com"
                  />
                </div>
                <div class="form-group">
                  <label>Education</label>
                  <input
                    type="text"
                    id="contact-education"
                    placeholder="e.g., BSc in Software Engineering, NIBM"
                  />
                </div>
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i>
                  Save Contact Info
                </button>
              </form>
            </div>

            <div class="settings-card">
              <h3><i class="fas fa-code"></i> Skills Management</h3>
              <div class="skills-management">
                <div class="skills-categories">
                  <div class="skill-category">
                    <h4>
                      <i class="fas fa-laptop-code"></i> Programming Languages
                    </h4>
                    <div class="skill-items" id="programming-skills">
                      <!-- Skills will be loaded here -->
                    </div>
                    <button
                      type="button"
                      onclick="addSkill('programming')"
                      class="btn-secondary"
                    >
                      <i class="fas fa-plus"></i>
                      Add Language
                    </button>
                  </div>

                  <div class="skill-category">
                    <h4><i class="fas fa-globe"></i> Web Technologies</h4>
                    <div class="skill-items" id="web-skills">
                      <!-- Skills will be loaded here -->
                    </div>
                    <button
                      type="button"
                      onclick="addSkill('web')"
                      class="btn-secondary"
                    >
                      <i class="fas fa-plus"></i>
                      Add Technology
                    </button>
                  </div>

                  <div class="skill-category">
                    <h4>
                      <i class="fas fa-mobile-alt"></i> Mobile Development
                    </h4>
                    <div class="skill-items" id="mobile-skills">
                      <!-- Skills will be loaded here -->
                    </div>
                    <button
                      type="button"
                      onclick="addSkill('mobile')"
                      class="btn-secondary"
                    >
                      <i class="fas fa-plus"></i>
                      Add Technology
                    </button>
                  </div>

                  <div class="skill-category">
                    <h4><i class="fas fa-database"></i> Databases</h4>
                    <div class="skill-items" id="database-skills">
                      <!-- Skills will be loaded here -->
                    </div>
                    <button
                      type="button"
                      onclick="addSkill('database')"
                      class="btn-secondary"
                    >
                      <i class="fas fa-plus"></i>
                      Add Database
                    </button>
                  </div>

                  <div class="skill-category">
                    <h4><i class="fas fa-microchip"></i> IoT & Hardware</h4>
                    <div class="skill-items" id="iot-skills">
                      <!-- Skills will be loaded here -->
                    </div>
                    <button
                      type="button"
                      onclick="addSkill('iot')"
                      class="btn-secondary"
                    >
                      <i class="fas fa-plus"></i>
                      Add Technology
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab">
          <div class="tab-header">
            <h2><i class="fas fa-cog"></i> Settings</h2>
          </div>
          <div class="settings-grid">
            <div class="settings-card">
              <h3><i class="fas fa-key"></i> Change Password</h3>
              <form id="password-form">
                <input
                  type="password"
                  id="current-password"
                  placeholder="Current Password"
                  required
                />
                <input
                  type="password"
                  id="new-password"
                  placeholder="New Password"
                  required
                />
                <input
                  type="password"
                  id="confirm-password"
                  placeholder="Confirm Password"
                  required
                />
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i>
                  Change Password
                </button>
              </form>
            </div>
            <div class="settings-card">
              <h3><i class="fas fa-shield-alt"></i> Security Settings</h3>
              <div class="security-info">
                <p>
                  <strong>Session Timeout:</strong>
                  <span id="session-timeout">30 minutes</span>
                </p>
                <p>
                  <strong>Inactivity Timeout:</strong>
                  <span id="inactivity-timeout">10 minutes</span>
                </p>
                <p>
                  <strong>Max Login Attempts:</strong>
                  <span id="max-attempts">5</span>
                </p>
                <p>
                  <strong>Account Lockout:</strong>
                  <span id="lockout-duration">15 minutes</span>
                </p>
              </div>
              <button
                onclick="adminDashboard.forceLogout()"
                class="btn-warning"
              >
                <i class="fas fa-sign-out-alt"></i>
                Force Logout All Sessions
              </button>
            </div>
            <div class="settings-card">
              <h3><i class="fas fa-database"></i> Data Management</h3>
              <button onclick="exportData()" class="btn-secondary">
                <i class="fas fa-download"></i>
                Export Data
              </button>
              <button onclick="importData()" class="btn-secondary">
                <i class="fas fa-upload"></i>
                Import Data
              </button>
              <button onclick="clearData()" class="btn-danger">
                <i class="fas fa-trash"></i>
                Clear All Data
              </button>
            </div>
            <div class="settings-card">
              <h3><i class="fas fa-tools"></i> System Diagnostics</h3>
              <button
                onclick="adminDashboard.runDiagnostics()"
                class="btn-secondary"
              >
                <i class="fas fa-stethoscope"></i>
                Run Diagnostics
              </button>
              <button
                onclick="adminDashboard.retryConnection()"
                class="btn-secondary"
              >
                <i class="fas fa-sync-alt"></i>
                Retry Connection
              </button>
              <p
                style="
                  margin-top: 1rem;
                  font-size: 0.9rem;
                  color: var(--text-secondary);
                "
              >
                Use these tools to troubleshoot connection issues and verify
                system status.
              </p>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Modals -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modal-title">Add Item</h3>
          <button onclick="closeModal()" class="close-btn">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <form id="modal-form">
          <div id="modal-fields"></div>
          <div class="modal-actions">
            <button type="button" onclick="closeModal()" class="btn-secondary">
              <i class="fas fa-times"></i>
              Cancel
            </button>
            <button type="submit" class="btn-primary">
              <i class="fas fa-save"></i>
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <!-- FullCalendar scripts removed to fix loading issues -->

    <!-- Firebase Config -->
    <script src="../firebase-config.js"></script>

    <!-- Your Scripts -->
    <script src="../script/admin-firebase.js"></script>
  </body>
</html>
